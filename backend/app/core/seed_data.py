from sqlalchemy.orm import Session
from models.prompt_style import PromptStyle
from core.database import SessionLocal


def seed_prompt_styles(db: Session) -> None:
    """–ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É prompt_styles –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ
    existing_styles = db.query(PromptStyle).count()
    if existing_styles > 0:
        print(f"üìã –°—Ç–∏–ª–∏ –ø—Ä–æ–º–ø—Ç–æ–≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç ({existing_styles} –∑–∞–ø–∏—Å–µ–π), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é")
        return
    
    # –°–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
    styles_data = [
        {
            "id": 1,
            "name": "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π",
            "description": "–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å —Ç–æ—á–Ω—ã–º–∏ –∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏"
        },
        {
            "id": 2,
            "name": "–¢–≤–æ—Ä—á–µ—Å–∫–∏–π",
            "description": "–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏"
        },
        {
            "id": 3,
            "name": "–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π", 
            "description": "–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å —Ä–∞–∑–±–æ—Ä–æ–º –ø–æ –ø—É–Ω–∫—Ç–∞–º"
        },
        {
            "id": 4,
            "name": "–ü—Ä–æ—Å—Ç–æ–π",
            "description": "–ü–æ–Ω—è—Ç–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏"
        }
    ]
    
    print("üé® –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Å—Ç–∏–ª–µ–π –ø—Ä–æ–º–ø—Ç–æ–≤...")
    
    for style_data in styles_data:
        style = PromptStyle(
            id=style_data["id"],
            name=style_data["name"],
            description=style_data["description"]
        )
        db.add(style)
        print(f"  ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç–∏–ª—å: {style_data['name']} (ID: {style_data['id']})")
    
    try:
        db.commit()
        print("‚úÖ –í—Å–µ —Å—Ç–∏–ª–∏ –ø—Ä–æ–º–ø—Ç–æ–≤ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã!")
    except Exception as e:
        db.rollback()
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç–∏–ª–µ–π: {e}")
        raise


def seed_initial_data() -> None:
    """–ó–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
    print("üå± –ó–∞–ø—É—Å–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
    
    db = SessionLocal()
    try:
        seed_prompt_styles(db)
        print("‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö: {e}")
        raise
    finally:
        db.close()


if __name__ == "__main__":
    # –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é
    seed_initial_data()